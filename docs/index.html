<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>重力異常計算教學｜自由空間與布格改正（含 Python 程式）</title>
  <meta name="description" content="示範理論重力、自由空間改正、布格改正、自由空間重力異常與布格重力異常的完整步驟，含可複製 Python 程式碼與 (a)(b) 範例解答。">

  <style>
    :root{
      --bg:#0b1020;--panel:#12172a;--muted:#8aa0c4;--text:#e6ebff;--accent:#6aa6ff;--accent2:#8ef0ff;--code:#0e1326;
      --good:#78e08f;--bad:#ff6b6b;--warn:#ffd86b;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f7f9fd;--panel:#ffffff;--muted:#4a5b7d;--text:#222a3f;--accent:#2b6ef3;--accent2:#00a6b6;--code:#0e1326;
      }
    }
    *{box-sizing:border-box}
    body{margin:0;background:radial-gradient(1200px 800px at 10% -10%,#17203f,var(--bg)) fixed;color:var(--text);
         font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans TC,"PingFang TC","Microsoft JhengHei",Arial;
         line-height:1.7}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1200px;margin:0 auto;padding:24px}
    header{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);
           border-radius:18px;padding:26px;box-shadow:0 12px 28px rgba(0,0,0,.24)}
    .title{font-size:clamp(28px,4vw,44px);font-weight:800;margin:6px 0}
    .sub{color:var(--muted);max-width:75ch}
    .tag{display:inline-block;border:1px solid rgba(255,255,255,.18);padding:2px 8px;border-radius:999px;color:var(--muted);font-size:12px}
    main{display:grid;grid-template-columns:280px 1fr;gap:22px;margin-top:26px}
    @media (max-width:980px){main{grid-template-columns:1fr}}
    aside{position:sticky;top:16px;align-self:start;background:var(--panel);border:1px solid rgba(255,255,255,.08);
          border-radius:14px;padding:14px}
    .toc a{display:block;padding:8px 10px;border-radius:10px;color:var(--text)}
    .toc a:hover{background:rgba(255,255,255,.05)}
    .toc a.active{background:linear-gradient(90deg,rgba(106,166,255,.18),rgba(0,0,0,0));border:1px solid rgba(106,166,255,.4)}
    section.card{background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:20px;
                 box-shadow:0 10px 24px rgba(0,0,0,.18)}
    section.card+section.card{margin-top:16px}
    h2{margin:0 0 10px;font-size:clamp(22px,2.6vw,30px)}
    h3{margin:16px 0 8px;font-size:18px}
    p{margin:8px 0}
    ul,ol{margin:8px 0 8px 22px}
    .callout{background:rgba(255,255,255,.06);border:1px dashed rgba(255,255,255,.16);border-radius:12px;padding:10px 12px;color:var(--muted)}
    pre{position:relative;background:var(--code);color:#e8edff;border-radius:12px;padding:12px;border:1px solid rgba(255,255,255,.08);overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,Monaco,"Liberation Mono",monospace;font-size:13px}
    .copy{position:absolute;top:8px;right:8px;border:1px solid rgba(255,255,255,.15);background:#0b1020;color:#dbe4ff;
          padding:6px 9px;border-radius:10px;font-size:12px;cursor:pointer;opacity:.9}
    .copy:hover{opacity:1}
    .grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    @media (max-width:720px){.grid3{grid-template-columns:1fr}}
    .kpi{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px}
    .kpi .n{font-weight:800}
    footer{color:var(--muted);text-align:center;padding:28px 0}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="tag">Gravity • Free-Air & Bouguer Anomaly</div>
      <h1 class="title">重力異常計算教學：理論重力、自由空間改正與布格改正</h1>
      <p class="sub">根據題目（φ=48.1195°N、λ=12.1878°E、h=487.9 m、g<sub>obs</sub>=980,717.39 mGal），示範(a)陸地站與(b)海面站（同觀測值、海深=487.9 m）之完整解題流程。附可複製 Python 程式碼。</p>
    </header>

    <main>
      <aside>
        <nav class="toc" id="toc">
          <a href="#data">1. 題目資料</a>
          <a href="#formula">2. 公式與常數</a>
          <a href="#steps">3. 解題步驟</a>
          <a href="#ans">4. (a)(b) 數值解答</a>
          <a href="#code">5. Python 程式碼</a>
          <a href="#notes">6. 備註與延伸</a>
        </nav>
      </aside>

      <div>
        <section id="data" class="card">
          <h2>1. 題目資料</h2>
          <ul>
            <li>緯度 φ = <b>48.1195° N</b>；經度 λ = 12.1878° E（本題計算不使用）</li>
            <li>高程 h = <b>487.9 m</b></li>
            <li>實測重力 \( g_\text{obs} \) = <b>980,717.39 mGal</b></li>
          </ul>
          <div class="grid3">
            <div class="kpi"><div class="n">單位換算</div><div>1 m/s² = 10⁵ mGal</div></div>
            <div class="kpi"><div class="n">海面案例</div><div>海面 h=0，水深 H 用於海域布格改正</div></div>
            <div class="kpi"><div class="n">忽略項</div><div>此示例忽略地形、潮汐、埃特沃什等細部改正</div></div>
          </div>
        </section>

        <section id="formula" class="card">
          <h2>2. 公式與常數</h2>
          <ol>
            <li><b>理論重力（近似 GRS80 緯度公式）</b><br>
              \( g_\text{th}(\phi)=9.780327\,[1+0.0053024\sin^2\phi-0.0000058\sin^22\phi]\ \text{m/s}^2 \)
            </li>
            <li><b>自由空間改正（FAC）</b><br>
              \( \mathrm{FAC}=0.3086\,\mathrm{mGal/m}\times h \)
            </li>
            <li><b>布格改正（BC，平板）</b><br>
              \( \mathrm{BC}=2\pi G\rho h \approx 0.04193\,\rho\,h\ \mathrm{mGal} \)<br>
              陸域岩石密度 \( \rho_r=2.67\ \text{g/cm}^3 \)；海域水密度 \( \rho_w=1.03\ \text{g/cm}^3 \)。<br>
              海域布格改正取 <b>負號</b>：\( \mathrm{BC}_{marine} = -0.04193\,\rho_w\,H \)。
            </li>
            <li><b>異常定義</b><br>
              \( \Delta g_\mathrm{FA}=g_\mathrm{obs}-g_\mathrm{th}+\mathrm{FAC} \)<br>
              \( \Delta g_\mathrm{B}=\Delta g_\mathrm{FA}-\mathrm{BC} \)
            </li>
          </ol>
          <p class="callout">直覺：上升到高處 → FAC 為正（需加回）；陸地 BC 為正但在異常中被扣除；海面無 FAC，且 BC 為負值（代入等於加上一個正值）。</p>
        </section>

        <section id="steps" class="card">
          <h2>3. 解題步驟</h2>
          <ol>
            <li>由緯度用式(1)算 \( g_\text{th} \)（轉 mGal）。</li>
            <li>陸地：以 h=487.9 m 代入式(2)得 FAC；以 ρ=2.67、h=487.9 m 代入式(3)得 BC。</li>
            <li>海面：h=0 ⇒ FAC=0；以 ρ<sub>w</sub>=1.03、H=487.9 m 進式(3)（<b>加負號</b>）得 \( \mathrm{BC}_{marine} \)。</li>
            <li>分別帶入式(4)得到自由空間與布格異常。</li>
          </ol>
        </section>

        <section id="ans" class="card">
          <h2>4. (a)(b) 數值解答（四捨五入至 0.01 mGal）</h2>
          <h3>(a) 陸地站（h = 487.9 m）</h3>
          <ul>
            <li>理論重力 \(g_\text{th}\) = <b>980,901.85</b> mGal</li>
            <li>FAC = <b>150.57</b> mGal； BC (ρ=2.67) = <b>54.62</b> mGal</li>
            <li>自由空間異常 \( \Delta g_\mathrm{FA} \) = <b>−33.89</b> mGal</li>
            <li>布格異常 \( \Delta g_\mathrm{B} \) = <b>−88.51</b> mGal</li>
          </ul>
          <h3>(b) 海面（同觀測值，水深 H = 487.9 m）</h3>
          <ul>
            <li>FAC = 0 → \( \Delta g_\mathrm{FA}=g_\mathrm{obs}-g_\mathrm{th} \) = <b>−184.46</b> mGal</li>
            <li>海域布格改正 \( \mathrm{BC}_{marine} \) = <b>−21.07</b> mGal</li>
            <li>布格異常 \( \Delta g_\mathrm{B} \) = <b>−163.39</b> mGal</li>
          </ul>
        </section>

        <section id="code" class="card">
          <h2>5. Python 程式碼（可直接複製）</h2>
<pre><button class="copy">複製</button><code class="language-python">import math

# ======= 輸入區 =======
lat_deg = 48.1195             # 緯度 (deg)
h_land  = 487.9               # 陸地高程 (m)
g_obs   = 980_717.39          # 觀測重力 (mGal)

rho_rock = 2.67               # 岩石密度 (g/cm^3)
rho_water = 1.03              # 海水密度 (g/cm^3)

water_depth = 487.9           # 海域水深 (m)
# =======================

# 1) 理論重力 (mGal) — 近似 GRS80 緯度公式
phi = math.radians(lat_deg)
g_th_ms2 = 9.780327 * (1 + 0.0053024 * math.sin(phi)**2 - 0.0000058 * math.sin(2*phi)**2)
g_th = g_th_ms2 * 1e5  # mGal

# 2) 自由空間改正 (mGal/m)
FAC_per_m = 0.3086
FAC_land = FAC_per_m * h_land

# 3) 布格改正常數 (mGal / (g/cm^3·m))
B_const = 0.04193

# 陸域：正的 BC 值（在異常公式中會被扣除）
BC_land = B_const * rho_rock * h_land

# 4) 陸域異常
dg_FA_land = g_obs - g_th + FAC_land
dg_B_land  = dg_FA_land - BC_land

# 5) 海面（h=0，無 FAC；海域 BC 為負）
FAC_sea = 0.0
dg_FA_sea = g_obs - g_th + FAC_sea
BC_marine = -B_const * rho_water * water_depth
dg_B_sea = dg_FA_sea - BC_marine  # 等同 dg_FA_sea + B_const*rho_water*H

# ======= 列印結果 =======
def pr(label, val): print(f"{label:22s}: {val:,.2f} mGal")

print("=== (a) 陸地站點（h = 487.9 m） ===")
pr("Theoretical gravity", g_th)
pr("Free-air correction", FAC_land)
pr("Bouguer correction", BC_land)
pr("Free-air anomaly", dg_FA_land)
pr("Bouguer anomaly", dg_B_land)

print("\n=== (b) 海面（水深 = 487.9 m） ===")
pr("Free-air anomaly", dg_FA_sea)
pr("Marine Bouguer corr.", BC_marine)  # 注意為負值
pr("Bouguer anomaly", dg_B_sea)</code></pre>
          <p class="callout">需要把常數做成可輸入、或加入地形/潮汐/埃特沃什改正的版本，我可以再幫你升級成互動式計算器。</p>
        </section>

        <section id="notes" class="card">
          <h2>6. 備註與延伸</h2>
          <ul>
            <li>單位：程式輸出皆為 mGal。若需 m/s²，除以 10⁵ 即可。</li>
            <li>陸地布格改正用教科書常見的 <code>ρ=2.67 g/cm³</code>；實務可換成本地密度。</li>
            <li>完整布格異常還需地形改正（TC）與其他改正項。</li>
          </ul>
        </section>

        <footer>Made with ❤️ · 可自由修改與散佈（請保留出處）</footer>
      </div>
    </main>
  </div>

  <!-- Prism.js syntax highlight -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"
          data-autoloader-path="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/"></script>

  <script>
    // Copy buttons
    document.addEventListener('click', async (e)=>{
      if(!e.target.classList.contains('copy')) return;
      const code = e.target.nextElementSibling?.innerText || '';
      try{
        await navigator.clipboard.writeText(code);
        const b=e.target, old=b.textContent;
        b.textContent='已複製！'; b.style.background='linear-gradient(135deg,var(--good),#b8f7c7)'; b.style.color='#07120a';
        setTimeout(()=>{b.textContent=old; b.removeAttribute('style');}, 1200);
      }catch(err){
        e.target.textContent='無法複製';
      }
    });

    // TOC highlight by scroll
    const sections=[...document.querySelectorAll('section.card')];
    const links=[...document.querySelectorAll('.toc a')];
    const map=new Map(sections.map(s=>[s.id,links.find(a=>a.getAttribute('href')==='#'+s.id)]));
    const io=new IntersectionObserver(es=>{
      es.forEach(en=>{
        const id=en.target.id, a=map.get(id); if(!a) return;
        if(en.isIntersecting){ links.forEach(x=>x.classList.remove('active')); a.classList.add('active'); }
      })
    },{rootMargin:'-40% 0px -55% 0px',threshold:0.15});
    sections.forEach(s=>io.observe(s));
  </script>
</body>
</html>